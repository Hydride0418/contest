(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-340410ce"],{"0b42":function(e,t,a){var l=a("da84"),i=a("e8b5"),r=a("68ee"),o=a("861d"),n=a("b622"),s=n("species"),c=l.Array;e.exports=function(e){var t;return i(e)&&(t=e.constructor,r(t)&&(t===c||i(t.prototype))?t=void 0:o(t)&&(t=t[s],null===t&&(t=void 0))),void 0===t?c:t}},"0bec":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-main",[a("div",{staticStyle:{"margin-bottom":"15px"}},[a("span",{staticStyle:{"font-size":"13px","margin-right":"10px"}},[e._v("批次名称")]),a("el-input",{staticStyle:{width:"250px","margin-top":"10px"},attrs:{placeholder:"请输入内容"},model:{value:e.batch_name,callback:function(t){e.batch_name=t},expression:"batch_name"}}),a("span",{staticStyle:{"font-size":"13px","margin-left":"10px"}},[e._v("评审指标")]),a("el-input",{staticStyle:{width:"250px","margin-left":"10px"},attrs:{placeholder:"请输入内容"},model:{value:e.rule_name,callback:function(t){e.rule_name=t},expression:"rule_name"}}),a("span",{staticStyle:{"font-size":"13px","margin-left":"15px"}},[e._v("赛事名称")]),a("el-input",{staticStyle:{width:"250px","margin-top":"5px","margin-left":"10px"},attrs:{placeholder:"请输入内容"},model:{value:e.contest_name,callback:function(t){e.contest_name=t},expression:"contest_name"}}),a("div",{staticStyle:{float:"right"}},[a("span",{staticStyle:{"margin-right":"10px"}},[a("el-button",{on:{click:e.load}},[e._v("查询")])],1),a("span",[a("el-button",{on:{click:e.empty}},[e._v("清空")])],1)])],1),a("div",{staticStyle:{float:"left","margin-bottom":"10px"}},[a("el-button",{staticStyle:{"margin-bottom":"5px"},attrs:{type:"primary"},on:{click:e.handleAdd}},[a("i",{staticClass:"el-icon-circle-plus-outline",staticStyle:{"margin-right":"5px"}}),e._v("新增批次")])],1),a("div",{staticStyle:{float:"right","margin-bottom":"10px"}},[a("el-button",{staticStyle:{"margin-bottom":"5px"},on:{click:e.exp}},[a("i",{staticClass:"el-icon-download",staticStyle:{"margin-left":"5px"}}),e._v("导出评审批次信息")])],1),a("el-table",{attrs:{data:e.tableData,border:"",strips:"","header-cell-class-name":e.headerBg}},[a("el-table-column",{attrs:{type:"index",index:e.indexFn,width:"50"}}),a("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.checkInfo(t.row)}}},[e._v("查看批次信息")])]}}])}),a("el-table-column",{attrs:{prop:"name",label:"批次名称",width:"140"}}),a("el-table-column",{attrs:{prop:"rule.name",label:"评审指标",width:"140"}}),a("el-table-column",{attrs:{prop:"contest.name",label:"赛事名称",width:"140"}}),a("el-table-column",{attrs:{prop:"work_expert",label:"作品评审专家数量",width:"120"}}),a("el-table-column",{attrs:{prop:"expert_work",label:"专家评审作品数量",width:"120"}}),a("el-table-column",{attrs:{prop:"start_date",label:"评审开始时间",width:"210"}}),a("el-table-column",{attrs:{prop:"end_date",label:"评审截止时间",width:"210"}}),a("el-table-column",{attrs:{prop:"is_aveg",label:"是否去除最大最小成绩",width:"160"}}),a("el-table-column",{attrs:{prop:"is_max",label:"是否只取最大成绩",width:"140"}})],1),a("div",{staticStyle:{padding:"10px 0"}},[a("el-pagination",{staticStyle:{float:"right"},attrs:{"current-page":e.pageNum,"page-sizes":[2,5,10,20],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:"批次信息",visible:e.dialogFormVisible,width:"30%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"160px"}},[this.batchForm.name?a("el-form-item",{attrs:{label:"批次名称"}},[e._v(" ："+e._s(this.batchForm.name)+" ")]):e._e(),this.batchForm.rule.name?a("el-form-item",{attrs:{label:"评审指标"}},[e._v(" ："+e._s(this.batchForm.rule.name)+" ")]):e._e(),a("el-form-item",{attrs:{label:"赛事名称"}},[e._v(" ："+e._s(this.batchForm.contest.name)+" ")]),a("el-form-item",{attrs:{label:"作品评审专家数量"}},[e._v(" ："+e._s(this.batchForm.work_expert)+" ")]),a("el-form-item",{attrs:{label:"专家评审作品数量"}},[e._v(" ："+e._s(this.batchForm.expert_work)+" ")]),a("el-form-item",{attrs:{label:"评审开始时间"}},[e._v(" ："+e._s(this.batchForm.start_date)+" ")]),a("el-form-item",{attrs:{label:"评审截止时间"}},[e._v(" ："+e._s(this.batchForm.end_date)+" ")]),a("el-form-item",{attrs:{label:"是否去除最大最小成绩"}},[e._v(" ："+e._s(this.batchForm.is_aveg)+" ")]),a("el-form-item",{attrs:{label:"是否只取最大成绩"}},[e._v(" ："+e._s(this.batchForm.is_max)+" ")])],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("关 闭")])],1)],1),a("el-dialog",{attrs:{title:"新增批次",visible:e.dialogVisible,width:"70%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-steps",{attrs:{active:e.active,"finish-status":"success",simple:""}},[a("el-step",{attrs:{title:"批次基本信息"}}),a("el-step",{attrs:{title:"选择作品"}}),a("el-step",{attrs:{title:"选择专家"}}),a("el-step",{attrs:{title:"评审任务分配"}})],1),0===e.active?a("div",{staticStyle:{"margin-top":"20px"}},[a("el-form",{ref:"batchCache",attrs:{"label-position":e.labelPosition,"label-width":"140px",model:e.batchCache}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"批次名称",required:!0}},[a("el-input",{model:{value:e.batchCache.name,callback:function(t){e.$set(e.batchCache,"name",t)},expression:"batchCache.name"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"评审指标",required:!0}},[a("el-select",{staticStyle:{width:"220px"},attrs:{placeholder:"请选择评审指标"},model:{value:e.batchCache.rule_id,callback:function(t){e.$set(e.batchCache,"rule_id",t)},expression:"batchCache.rule_id"}},[a("el-option",{attrs:{label:"自由选题",value:"1"}}),a("el-option",{attrs:{label:"政府出题",value:"2"}})],1)],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"作品评审专家数量",required:!0}},[a("el-input",{model:{value:e.batchCache.work_expert,callback:function(t){e.$set(e.batchCache,"work_expert",t)},expression:"batchCache.work_expert"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"专家评审作品上限",required:!0}},[a("el-input",{model:{value:e.batchCache.expert_work,callback:function(t){e.$set(e.batchCache,"expert_work",t)},expression:"batchCache.expert_work"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"评审开始日期",required:!0}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择开始日期"},model:{value:e.batchCache.start_date,callback:function(t){e.$set(e.batchCache,"start_date",t)},expression:"batchCache.start_date"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"评审截至日期",required:!0}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择截至日期"},model:{value:e.batchCache.end_date,callback:function(t){e.$set(e.batchCache,"end_date",t)},expression:"batchCache.end_date"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"去除最大最小成绩"}},[a("el-radio",{attrs:{label:"是"},model:{value:e.is_aveg,callback:function(t){e.is_aveg=t},expression:"is_aveg"}},[e._v("是")]),a("el-radio",{attrs:{label:"否"},model:{value:e.is_aveg,callback:function(t){e.is_aveg=t},expression:"is_aveg"}},[e._v("否")])],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"只取最大成绩"}},[a("el-radio",{attrs:{label:"是"},model:{value:e.is_max,callback:function(t){e.is_max=t},expression:"is_max"}},[e._v("是")]),a("el-radio",{attrs:{label:"否"},model:{value:e.is_max,callback:function(t){e.is_max=t},expression:"is_max"}},[e._v("否")])],1)],1)],1)],1)],1):e._e(),1===e.active?a("div",{staticStyle:{"margin-top":"20px"}},[a("el-table",{attrs:{data:e.tableTeamData,border:"",strips:"","header-cell-class-name":e.headerBg},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{type:"index",index:e.indexFn,width:"50"}}),a("el-table-column",{attrs:{prop:"name",label:"团队名称",width:"180"}}),a("el-table-column",{attrs:{prop:"question.name",label:"赛题",width:"180"}}),a("el-table-column",{attrs:{prop:"team_leader",label:"队长姓名",width:"180"}}),a("el-table-column",{attrs:{prop:"leader_school",label:"队长所在学校",width:"180"}}),a("el-table-column",{attrs:{prop:"leader_phone",label:"队长手机号",width:"180"}}),a("el-table-column",{attrs:{prop:"advisor",label:"指导教师",width:"160"}}),a("el-table-column",{attrs:{prop:"submit_date",label:"提交作品时间",width:"220"}})],1)],1):e._e(),2===e.active?a("div",{staticStyle:{"margin-top":"20px"}},[a("el-table",{attrs:{data:e.tableExpertData,border:"",strips:"","header-cell-class-name":e.headerBg},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{type:"index",index:e.indexFn,width:"50"}}),a("el-table-column",{attrs:{prop:"name",label:"姓名",width:"140"}}),a("el-table-column",{attrs:{prop:"gender_show",label:"性别",width:"100"}}),a("el-table-column",{attrs:{prop:"organization_name",label:"所在单位",width:"140"}}),a("el-table-column",{attrs:{prop:"major_name",label:"专业名称",width:"140"}}),a("el-table-column",{attrs:{prop:"research_direction",label:"研究方向",width:"140"}}),a("el-table-column",{attrs:{prop:"remarks",label:"评阅备注",width:"140"}}),a("el-table-column",{attrs:{prop:"phone",label:"手机号",width:"140"}}),a("el-table-column",{attrs:{prop:"email",label:"电子邮箱",width:"140"}}),a("el-table-column",{attrs:{prop:"create_date",label:"创建时间",width:"220"}})],1)],1):e._e(),3===e.active?a("div",{staticStyle:{"margin-top":"20px"}},[a("el-table",{attrs:{data:e.tableAlloctionData,border:"",strips:"","header-cell-class-name":e.headerBg}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{type:"index",label:"序号",index:e.indexFn,width:"50"}}),a("el-table-column",{attrs:{prop:"name",label:"团队名称",width:"200"}}),a("el-table-column",{attrs:{prop:"question.name",label:"赛题名称",width:"200"}}),a("el-table-column",{attrs:{prop:"leader_school",label:"所属单位",width:"200"}}),a("el-table-column",{attrs:{prop:"work_expert",label:"已分配专家数量",width:"140"}}),a("el-table-column",{attrs:{prop:"experts",label:"专家",width:"400"}})],1)],1):e._e(),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.back}},[e._v(e._s(this.beforeButton))]),a("el-button",{attrs:{type:"primary"},on:{click:e.next}},[e._v("下一步")])],1)],1)],1)],1)},i=[],r=(a("fb6a"),a("e9c4"),a("b0c0"),a("d81d"),a("b775")),o={name:"Psgl",data:function(){return{batchCache:{name:"",rule_id:"",work_expert:"",expert_work:"",start_date:"",end_date:"",is_aveg:"否",is_max:"否"},labelPosition:"right",beforeButton:"取消",active:0,tableData:[],tableCache:[],tableTeamData:[],tableExpertData:[],tableAlloctionData:[],total:0,pageNum:1,pageSize:5,batchForm:{rule:{},contest:{}},batch_id:0,rule:{},contest:{},question:"",team_name:"",team_leader:"",leader_school:"",leader_phone:"",advisor:"",submit_date:"",is_award:"",name:"",batch_name:"",rule_name:"",contest_name:"",work_expert:0,expert_work:0,start_date:"",end_date:"",is_aveg:"否",is_max:"否",headerBg:"headerBg",dialogFormVisible:!1,dialogVisible:!1,form:{batch_name:"",rule_name:"",contest_name:""},multipleWorkSelection:[],multipleExpertSelection:[],expert_works:[]}},created:function(){this.load()},methods:{load:function(){var e=this;this.form.batch_name=this.batch_name,this.form.rule_name=this.rule_name,this.form.contest_name=this.contest_name,r["a"].post("/batch/query_batch",this.form).then((function(t){e.tableCache=t,e.getTableData(),e.total=t.length}))},getTableData:function(){this.tableData=this.tableCache.slice((this.pageNum-1)*this.pageSize,this.pageNum*this.pageSize)},empty:function(){this.batch_name="",this.rule_name="",this.contest_name="",this.load()},indexFn:function(e){return e=e+1+(this.pageNum-1)*this.pageSize,e},handleSizeChange:function(e){this.pageSize=e,this.load()},handleCurrentChange:function(e){this.pageNum=e,this.load()},handleAdd:function(){this.active=0,this.dialogVisible=!0,this.form={},0===this.active?this.beforeButton="关  闭":this.beforeButton="上一步"},save:function(e){var t=this;this.$refs[e].validate((function(e){e?r["a"].post("/admin/save_admin",t.form).then((function(e){console.log(e),200===e.code?(t.$message.success("保存成功"),t.dialogFormVisible=!1,t.load()):t.$message.error("保存失败")})):console.log("提交失败")}))},checkInfo:function(e){this.batchForm=JSON.parse(JSON.stringify(e)),this.dialogFormVisible=!0},back:function(){this.active--,-1===this.active&&(this.dialogVisible=!1),0===this.active?this.beforeButton="关  闭":this.beforeButton="上一步"},next:function(){var e=this;if(this.active++,4===this.active&&(this.dialogVisible=!1),this.beforeButton="上一步",1===this.active&&r["a"].get("/team/query_info",{params:{contest:"",question:"",team_name:"",team_leader:"",leader_school:"",leader_phone:"",is_award:1}}).then((function(t){e.tableTeamData=t,e.multipleWorkSelection=e.multipleSelection})),2===this.active&&r["a"].get("/expert/get").then((function(t){for(var a=0;a<t.length;a++)1===t[a].gender?t[a].gender_show="男":t[a].gender_show="女";e.tableExpertData=t,e.multipleExpertSelection=e.multipleSelection})),3===this.active){this.tableAlloctionData=this.multipleWorkSelection,r["a"].post("/batch/add_batch",this.batchCache).then((function(t){200!=t.code?(e.$message.error("新增批次失败"),e.dialogVisible=!1):e.batch_id=t.batch_id})),console.log(this.batch_id);for(var t=0;t<this.multipleExpertSelection.length;t++)this.expert_works[t]=0;for(t=0;t<this.multipleWorkSelection.length;t++)for(var a=0,l=0;l<this.multipleExpertSelection.length;l++){if(a===this.batchCache.work_expert){console.log(this.multipleWorkSelection[t].work_expert),this.multipleWorkSelection[t].work_expert=a;break}if(this.expert_works[l]<this.expert_work){this.multipleWorkSelection[t].experts=this.multipleExpertSelection[l].name+",",this.expert_works[l]++,a++;var i,o=this.multipleExpertSelection[l],n=this.multipleWorkSelection[t];i.expert_id=o,i.work_id=n,i.batch_id=this.batch_id,i.is_valid=0,console.log(i),r["a"].post("/allocation/add_allocation",i).then((function(t){200!=t.code&&(e.$message.error("分配失败"),e.dialogVisible=!1)}))}}}},handleSelectionChange:function(e){1===this.active&&(this.multipleWorkSelection=e),2===this.active&&(this.multipleExpertSelection=e)},handleBatchDele:function(){var e=this,t=this.multipleSelection.map((function(e){return e.id}));r["a"].post("/admin/delete_batch",t).then((function(t){!0===t?(e.$message.success("批量删除成功"),e.load()):e.$message.error("批量删除失败")}))},exp:function(){window.open("http://localhost:9090/batch/export")},importSuccess:function(){this.$message.success("文件导入成功")}}},n=o,s=(a("99ea"),a("2877")),c=Object(s["a"])(n,l,i,!1,null,null,null);t["default"]=c.exports},"1dde":function(e,t,a){var l=a("d039"),i=a("b622"),r=a("2d00"),o=i("species");e.exports=function(e){return r>=51||!l((function(){var t=[],a=t.constructor={};return a[o]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},"65f0":function(e,t,a){var l=a("0b42");e.exports=function(e,t){return new(l(e))(0===t?0:t)}},8418:function(e,t,a){"use strict";var l=a("a04b"),i=a("9bf2"),r=a("5c6c");e.exports=function(e,t,a){var o=l(t);o in e?i.f(e,o,r(0,a)):e[o]=a}},"99ea":function(e,t,a){"use strict";a("e24e")},b727:function(e,t,a){var l=a("0366"),i=a("e330"),r=a("44ad"),o=a("7b0b"),n=a("07fa"),s=a("65f0"),c=i([].push),h=function(e){var t=1==e,a=2==e,i=3==e,h=4==e,d=6==e,p=7==e,u=5==e||d;return function(m,b,f,_){for(var g,v,x=o(m),w=r(x),k=l(b,f),S=n(w),y=0,C=_||s,F=t?C(m,S):a||p?C(m,0):void 0;S>y;y++)if((u||y in w)&&(g=w[y],v=k(g,y,x),e))if(t)F[y]=v;else if(v)switch(e){case 3:return!0;case 5:return g;case 6:return y;case 2:c(F,g)}else switch(e){case 4:return!1;case 7:c(F,g)}return d?-1:i||h?h:F}};e.exports={forEach:h(0),map:h(1),filter:h(2),some:h(3),every:h(4),find:h(5),findIndex:h(6),filterReject:h(7)}},d81d:function(e,t,a){"use strict";var l=a("23e7"),i=a("b727").map,r=a("1dde"),o=r("map");l({target:"Array",proto:!0,forced:!o},{map:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},e24e:function(e,t,a){},e8b5:function(e,t,a){var l=a("c6b6");e.exports=Array.isArray||function(e){return"Array"==l(e)}},e9c4:function(e,t,a){var l=a("23e7"),i=a("da84"),r=a("d066"),o=a("2ba4"),n=a("e330"),s=a("d039"),c=i.Array,h=r("JSON","stringify"),d=n(/./.exec),p=n("".charAt),u=n("".charCodeAt),m=n("".replace),b=n(1..toString),f=/[\uD800-\uDFFF]/g,_=/^[\uD800-\uDBFF]$/,g=/^[\uDC00-\uDFFF]$/,v=function(e,t,a){var l=p(a,t-1),i=p(a,t+1);return d(_,e)&&!d(g,i)||d(g,e)&&!d(_,l)?"\\u"+b(u(e,0),16):e},x=s((function(){return'"\\udf06\\ud834"'!==h("\udf06\ud834")||'"\\udead"'!==h("\udead")}));h&&l({target:"JSON",stat:!0,forced:x},{stringify:function(e,t,a){for(var l=0,i=arguments.length,r=c(i);l<i;l++)r[l]=arguments[l];var n=o(h,null,r);return"string"==typeof n?m(n,f,v):n}})},fb6a:function(e,t,a){"use strict";var l=a("23e7"),i=a("da84"),r=a("e8b5"),o=a("68ee"),n=a("861d"),s=a("23cb"),c=a("07fa"),h=a("fc6a"),d=a("8418"),p=a("b622"),u=a("1dde"),m=a("f36a"),b=u("slice"),f=p("species"),_=i.Array,g=Math.max;l({target:"Array",proto:!0,forced:!b},{slice:function(e,t){var a,l,i,p=h(this),u=c(p),b=s(e,u),v=s(void 0===t?u:t,u);if(r(p)&&(a=p.constructor,o(a)&&(a===_||r(a.prototype))?a=void 0:n(a)&&(a=a[f],null===a&&(a=void 0)),a===_||void 0===a))return m(p,b,v);for(l=new(void 0===a?_:a)(g(v-b,0)),i=0;b<v;b++,i++)b in p&&d(l,i,p[b]);return l.length=i,l}})}}]);
//# sourceMappingURL=chunk-340410ce.857dba4f.js.map